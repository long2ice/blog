---
title: "使用腾讯云香港轻量服务器和COS构建图床"
date: 2023-03-06T10:44:22+08:00
categories:
  - 程序天地
tags:
  - 腾讯云
  - COS
---

## 起因

因为有存储图片的需求，所以一直在寻找一种可靠的自建图床的方式，也尝试了很多种方案。

### 使用 Minio + 大盘鸡自建

- 优点：免费，开源。
- 缺点：需要自己维护，如果经常迁移服务器很不方便，另外如果需要存储大量图片的话，需要大硬盘机器。目前能找到最便宜的是 1TB 硬盘的机器，价格是 5 刀一个月。

### 使用 Wasabi 日本区域

- 优点：7 刀一个月，1TB 存储空间和 1TB 流量，速度还可以。
- 缺点：感觉还是有点贵。

### 使用 Vultr 对象存储新加坡区域

- 优点：5 刀一个月，1TB 存储空间和 1TB 流量。
- 缺点：新加坡国内访问还是有点慢。

### B2 云存储

没尝试，也是 5 刀一个月，1TB 存储空间和 1TB 流量，不过没有国内访问速度好点的节点。

## 方案选择

不考虑国内对象存储+CDN 的方式一个是价格太贵，另一个是有很多被 DDOS 然后产生天价账单的案例。

刚好最近迁移到了腾讯云香港轻量，老实说，尝试了各种商家的 VPS，各个地区包括美西、日本，最后还是选择了更稳定的大厂。

然后腾讯云香港轻量内网访问同区域 COS 是不收费的，另外直接暴露 COS 有被刷流量风险，所以最终选择通过轻量服务器中转的方式。

目前轻量上行限制 30M，暂时也够用了。

## 费用

COS 的存储费用还是很低的，请求费用也比较低，贵的是流量费用，所以通过轻量服务器中转的方式也比较便宜。

后续看需求吧，如果费用太高的话，也会考虑买一台香港大盘鸡进行自建。

## 中转方案

因为目前服务器使用的是 Caddy，使用 <https://github.com/lindenlab/caddy-s3-proxy> 这个插件可以直接代理 S3，而 COS 也兼容 S3。
